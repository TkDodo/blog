---
title: Effective Query Keys
description:
date: 2021-06-13
banner: ./keys.jpeg
tags:
  - react
  - react-query
  - JavaScript
  - TypeScript
---

import Comments from 'components/Comments'
import Attribution from 'components/Attribution'

<img src="./keys.jpeg" />

<Attribution name="Chunli Ju" url="https://unsplash.com/@chunlea" />

- [#1: Practical React Query](practical-react-query)
- [#2: React Query Data Transformations](react-query-data-transformations)
- [#3: React Query Render Optimizations](react-query-render-optimizations)
- [#4: Status Checks in React Query](status-checks-in-react-query)
- [#5: Testing React Query](testing-react-query)
- [#6: React Query and TypeScript](react-query-and-type-script)
- [#7: Using WebSockets with React Query](using-web-sockets-with-react-query)
- <b>#8: Effective Query Keys</b>

---

[Query Keys](https://react-query.tanstack.com/guides/query-keys) are a very important core concept in React Query. They are necessary so that the library can internally cache your data correctly and refetch automatically when a dependency to your query changes. Lastly, it will allow you to interact with the Query Cache manually when needed, for example when updating data after a mutation or when you need to manually invalidate some queries.

Let's quickly have a look what these three points mean before I'll show you how I personally organize Query Keys to be able to do these things most effectively.

### Caching Data

Internally, the Query Cache is just a JavaScript object, where the keys are serialized Query Keys and the values are your Query Data plus meta information. The keys are hashed it in a [deterministic way](https://react-query.tanstack.com/guides/query-keys#query-keys-are-hashed-deterministically), so you can use Objects as well (On the top level, keys have to be strings or Arrays though).

The most important part is that keys need to be _unique_ for your queries. If React Query finds an entry for a key in the cache, it will use it. Please also be aware that you cannot use the same key for _useQuery_ _and_ _useInfiniteQuery_. There is, after all, only _one_ Query Cache, and you would share the data between these two. That is not good because infinite queries have a fundamentally different structure than "normal" queries.

```ts:title=dont-mix-keys
useQuery(['todos'], fetchTodos)

// üö® this won't work
useInfiniteQuery(['todos'], fetchInfiniteTodos)

// ‚úÖ choose something else instead
useInfiniteQuery(['infiniteTodos'], fetchInfiniteTodos)
```

### Automatic Refetching

### Manual Interaction

### Effective Query Keys


---

That's it for today. Feel free to reach out to me on [twitter](https://twitter.com/tkdodo)
if you have any questions, or just leave a comment below ‚¨áÔ∏è

<Comments withSeparator={false} />
